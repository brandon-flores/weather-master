<!DOCTYPE html>
<html>
<head>
	<title>Weather Master</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>
<body>
	<div id="mainApp">
		<h1>Please input csv file:</h1>
		<p>
			<label>*.csv 
				<input
					type="file"
					accept=".csv"
					ref="filePicker"
					@change="handleFileInputChange"
				/>
				<input
					type="date"
					v-model="editedDate"
					:max='maxDate'
				/>
			</label>
		</p>
		<table class="table table-responsive">
			<thead>
			    <tr>
			        <th scope="col"></th>
			        <th scope="col">Name</th>
			        <th scope="col">Phone Number</th>
			        <th scope="col">City</th>
			        <th scope="col">Weather</th>
			    </tr>
			</thead>
			<tbody>
			    <tr v-for="customer in customers" v-if="!isFetching">
			        <td>
			        	<img
			        		:src="customer.user_profile.avatar.thumbnail_url"
			        		alt="picture"/>
			        </td>
			        <td>${ customer.user_profile.full_name }</td>
			        <td>${ customer.user_profile.phone_number }</td>
			        <td>${ customer.location.city }</td>
			        <td>
			        	<button
			        		type="button"
			        		class="btn btn-primary"
			        		data-toggle="modal"
			        		data-target="#weatherModal"
			        		:disabled="!editedDate"
			        		@click="showWeather(customer)"
			        	>
			        		View Weather
						</button>
					</td>
			    </tr>
			</tbody>
		</table>
		<!-- Modal -->
		<div
			v-if="weatherData || errorMessage.length"
			class="modal fade"
			id="weatherModal"
			tabindex="-1"
			role="dialog"
			aria-labelledby="exampleModalCenterTitle"
			aria-hidden="true"
		>
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLongTitle">Weather for ${ formattedDate }</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div v-if="errorMessage" class="modal-body">
						${errorMessage}
					</div>
					<div v-else-if="weatherData.location" class="modal-body">
						<h4>${weatherData.location.region}, ${weatherData.location.country}</h4>
					</div>
					<div v-else class="modal-body">
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
						<button type="button" class="btn btn-primary">Save changes</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://momentjs.com/downloads/moment.js"></script>
	<script src="../static/js/index.js" type="text/javascript"></script>
</body>
</html>